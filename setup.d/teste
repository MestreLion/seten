setuplib=${SETUP_LIB_PATH:-"$(dirname "$(readlink -f "$0")")"/../setuplib}
# shellcheck source=../setuplib
if [[ -r "$setuplib" ]]; then source "$setuplib"; else
	echo "Setup library not found: $setuplib" >&2; exit 1;
fi
message "Decrease syslog verbosity in rtkit-daemon used by Firefox"
override=/etc/systemd/system/rtkit-daemon.service.d/override.conf
sudo mkdir -p -- "${override%/*}"
sudo tee -- "$override" <<-EOF
	$(signature)

	# Decrease syslog verbosity in rtkit-daemon used by Firefox
	# to avoid it spamming "Supervising X threads of X processes of Y users."
	# https://bbs.archlinux.org/viewtopic.php?id=248893
	[Service]
	LogLevelMax=info
EOF
sudo systemctl daemon-reload
sudo systemctl restart rtkit-daemon.service  # needed to silence active service
